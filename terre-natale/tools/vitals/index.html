<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gestionnaire de Ressources - JDR</title>
  <!-- NES.css -->
  <link href="https://unpkg.com/nes.css@2.3.0/css/nes.min.css" rel="stylesheet" />
  <style>
    body { padding: 1.5rem; }
    .toolbar {
      display: grid;
      grid-template-columns: auto auto 1fr auto auto;
      gap: 0.75rem;
      align-items: center;
      margin-bottom: 1rem;
    }
    .toolbar .group { display: flex; gap: 0.5rem; align-items: center; }
    .resource-row {
      display: grid;
      grid-template-columns: auto 1fr auto auto;
      gap: 0.75rem;
      align-items: center;
      margin-bottom: 1rem;
    }
    .resource-meta {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      min-width: 180px;
      font-weight: 700;
    }
    .icon-img {
      width: 28px;
      height: 28px;
      image-rendering: pixelated;
      image-rendering: crisp-edges;
      border-radius: 4px;
      background: #eee;
    }
    .progress-wrap {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .value-text {
      min-width: 110px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
    .btns { display: flex; gap: 0.5rem; }
    .footer-note { margin-top: 1.5rem; font-size: 0.9rem; opacity: 0.85; }
    .grid-settings {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem 1rem;
      margin: 1rem 0;
    }
    .settings-section-title { margin-top: 0.5rem; font-weight: bold; }
    @media (max-width: 900px) {
      .toolbar {
        grid-template-columns: 1fr;
        grid-auto-rows: auto;
      }
    }
    @media (max-width: 600px) {
      .resource-row {
        grid-template-columns: 1fr;
        grid-auto-rows: auto;
      }
      .value-text, .btns { justify-self: start; }
    }
  </style>
</head>
<body>
  <section class="container">
    <h2 class="nes-text is-primary">Gestionnaire de Ressources</h2>

    <div class="toolbar">
      <div class="group">
        <button class="nes-btn is-primary" id="openSettings" title="Configurer maxima et récupérations">Configurations</button>
        <button class="nes-btn" id="resetAll" title="Remettre toutes les valeurs au maximum">Tout au max</button>
      </div>

      <div class="group">
        <button class="nes-btn is-success" id="shortRest" title="Repos court">Repos court</button>
        <button class="nes-btn is-warning" id="longRest" title="Repos long">Repos long</button>
      </div>

      <div class="group" style="justify-self:center;">
        <label for="stepInput">Pas</label>
        <input type="number" id="stepInput" class="nes-input" min="1" step="1" style="width:90px" />
      </div>

      <div class="group" style="justify-self:end;">
        <label class="nes-checkbox" style="margin-right:0.25rem;">
          <input type="checkbox" id="counterEnabled" />
          <span>Utiliser le compteur</span>
        </label>
      </div>

      <div class="group" style="justify-self:end;">
        <label for="counterValue">Compteur</label>
        <input type="number" id="counterValue" class="nes-input" step="1" style="width:120px" />
      </div>
    </div>

    <div id="resources"></div>

    <p class="footer-note">
      Style par <a href="https://nostalgic-css.github.io/NES.css/" target="_blank">NES.css</a>. Images : placeholders PNG (remplaçables).
    </p>
  </section>

  <!-- Modal de paramètres (maxima + récupérations + globale) -->
  <dialog class="nes-dialog is-rounded" id="settingsDialog" aria-labelledby="dlg-title">
    <form method="dialog">
      <h3 id="dlg-title" class="nes-text is-primary">Configurations</h3>

      <p class="settings-section-title">Récupération globale</p>
      <div class="nes-field" style="max-width:260px;">
        <label for="globalRecovery">+Récup. globale (appliquée au repos long)</label>
        <input type="number" id="globalRecovery" class="nes-input" min="0" step="1" />
      </div>

      <p class="settings-section-title">Maxima &amp; Récupérations par ressource</p>
      <div class="grid-settings" id="settingsGrid">
        <!-- Inputs injectés via JS -->
      </div>
      <menu class="dialog-menu" style="display:flex; gap:0.5rem; justify-content:flex-end;">
        <button class="nes-btn" value="cancel">Annuler</button>
        <button class="nes-btn is-success" id="saveSettings" value="default">Enregistrer</button>
      </menu>
    </form>
  </dialog>

  <!-- Modal de confirmation pour reset par ressource -->
  <dialog class="nes-dialog is-rounded" id="confirmDialog" aria-labelledby="confirm-title" aria-describedby="confirm-desc">
    <form method="dialog">
      <h3 id="confirm-title" class="nes-text is-warning">Confirmer la réinitialisation</h3>
      <p id="confirm-desc">Voulez-vous remettre cette ressource à son maximum&nbsp;?</p>
      <menu class="dialog-menu" style="display:flex; gap:0.5rem; justify-content:flex-end;">
        <button class="nes-btn" value="cancel">Annuler</button>
        <button class="nes-btn is-error" id="confirmYes" value="default">Réinitialiser</button>
      </menu>
    </form>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
